# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Factory Field - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 2025-10-10
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** v0.7.8-dev
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

## ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• factory field ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô `{"‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ"}` ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô `‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ` (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤)

### ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥
‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß:** ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á `DynamicTableService.js` ‡πÉ‡∏´‡πâ‡πÅ‡∏õ‡∏•‡∏á array ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
- ‚úÖ **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà:** ‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ `‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ` (‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
- ‚ö†Ô∏è **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤:** ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `{"‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ"}` (‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å)

---

## ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### ‡∏ó‡∏≥‡πÑ‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô?

‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô **"‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô" (Preventive Fix)** ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà **"‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á" (Retroactive Fix)**

**‡∏≠‡∏∏‡∏õ‡∏°‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô:**
- ‡∏ã‡πà‡∏≠‡∏°‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏£‡∏±‡πà‡∏ß ‚Üí ‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏£‡∏±‡πà‡∏ß‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏´‡∏¢‡∏∏‡∏î ‚úÖ
- ‡πÅ‡∏ï‡πà‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô ‚ö†Ô∏è

**‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ:**
- Submission ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á restart backend ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚úÖ
- Submission ‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô restart ‚Üí ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤ ‚ö†Ô∏è

---

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:

1. **‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå** (Ctrl+R ‡∏´‡∏£‡∏∑‡∏≠ F5)

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á Submission ‡πÉ‡∏´‡∏°‡πà:**
   - ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ sub-form ‡∏û‡∏£‡πâ‡∏≠‡∏° factory field
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "Add Sub-Form Entry"
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô: "‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á"
   - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
   ```sql
   SELECT id, factory_affiliated, submitted_at
   FROM [your_subform_table_name]
   ORDER BY submitted_at DESC
   LIMIT 1;
   ```

4. **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:**
   ```
   | id        | factory_affiliated | submitted_at          |
   |-----------|--------------------|-----------------------|
   | new-id... | ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á       | 2025-10-10 14:30:00   | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!
   ```

---

## ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤ - 3 ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

### ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ Migration Script (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

**‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:**
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡πÉ‡∏ä‡πâ Regex Pattern ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö)
- ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß (‡∏ó‡∏≥‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à)

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥:**
```bash
cd backend/scripts
node fix-factory-field-format.js
```

**Script ‡∏à‡∏∞‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:**
1. ‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ factory field
2. ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å `{"‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á"}` ‚Üí `‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á`
3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `{"..."}`

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Output:**
```
üîç Found 3 tables with factory fields
‚úÖ Fixed factory_affiliated in sub_form_table_abc (2 records)
‚úÖ Fixed factory_affiliated in sub_form_table_def (1 record)
‚úÖ Complete! Total fixed: 3 records
```

---

### ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏ß‡πâ‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°

**‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö:**
- ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏Å (< 10 records)
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ö‡πà‡∏≠‡∏¢

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:**
- Frontend ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á 2 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
- PowerBI report ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ data cleaning

**‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:**
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢:**
- ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 2 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏ô‡∏Å‡∏±‡∏ô

---

### ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 3: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Manual)

**‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö:**
- ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1-2 ‡πÅ‡∏ñ‡∏ß
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ó‡∏µ‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥ (‡πÉ‡∏ä‡πâ pgAdmin ‡∏´‡∏£‡∏∑‡∏≠ psql):**
```sql
-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
UPDATE [your_subform_table_name]
SET factory_affiliated = '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ'
WHERE id = '5af9af2f-b4ec-4af4-a7b1-a0cfbd20f0eb';

UPDATE [your_subform_table_name]
SET factory_affiliated = '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á'
WHERE id = 'd45f53c7-77d9-499d-ab27-ee7b8870159c';
```

---

## Migration Script (fix-factory-field-format.js)

**Location:** `backend/scripts/fix-factory-field-format.js`

```javascript
const { Pool } = require('pg');
require('dotenv').config();

async function fixFactoryFieldFormat() {
  const pool = new Pool({
    host: process.env.DB_HOST,
    port: process.env.DB_PORT,
    database: process.env.DB_NAME,
    user: process.env.DB_USER,
    password: process.env.DB_PASSWORD
  });

  try {
    console.log('üîç Scanning for tables with factory fields...\n');

    // Find all columns that might be factory fields
    const columnsQuery = `
      SELECT DISTINCT table_name, column_name
      FROM information_schema.columns
      WHERE table_schema = 'public'
        AND (
          column_name LIKE '%factory%'
          OR column_name LIKE '%affiliated%'
          OR column_name = 'factory_affiliated'
        )
      ORDER BY table_name;
    `;

    const { rows: columns } = await pool.query(columnsQuery);
    console.log(`‚úÖ Found ${columns.length} columns to check:\n`);

    let totalFixed = 0;

    for (const { table_name, column_name } of columns) {
      console.log(`üìã Checking ${table_name}.${column_name}...`);

      // Update records with JSON format to plain text
      // Pattern: {"value"} ‚Üí value
      const updateQuery = `
        UPDATE "${table_name}"
        SET "${column_name}" = regexp_replace(
          "${column_name}",
          '^\\{"([^"]+)"\\}$',
          '\\1'
        )
        WHERE "${column_name}" ~ '^\\{"[^"]+"\\}$'
        RETURNING id, "${column_name}";
      `;

      const { rows: updated, rowCount } = await pool.query(updateQuery);

      if (rowCount > 0) {
        console.log(`   ‚úÖ Fixed ${rowCount} records in ${table_name}.${column_name}`);
        console.log(`   Example: ${updated[0][column_name]}`);
        totalFixed += rowCount;
      } else {
        console.log(`   ‚ÑπÔ∏è  No records need fixing in ${table_name}.${column_name}`);
      }
      console.log();
    }

    console.log(`\nüéâ Migration Complete!`);
    console.log(`üìä Total records fixed: ${totalFixed}`);

  } catch (error) {
    console.error('‚ùå Migration failed:', error);
    throw error;
  } finally {
    await pool.end();
  }
}

// Run migration
fixFactoryFieldFormat()
  .then(() => process.exit(0))
  .catch(error => {
    console.error(error);
    process.exit(1);
  });
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```bash
# 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
cd backend/scripts
nano fix-factory-field-format.js
# (‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)

# 2. ‡∏£‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå
node fix-factory-field-format.js

# 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
psql -U qcollector_user -d qcollector_dev -c "SELECT factory_affiliated FROM [table_name] LIMIT 5;"
```

---

## ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ (FAQ)

### Q1: ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ô‡∏µ‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠ field ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà ‡∏°‡∏µ‡∏ú‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞ field ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô array ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô:
- ‚úÖ `factory` field
- ‚úÖ `dropdown` field (‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô array)
- ‚úÖ `multiple_choice` field (single selection)
- ‚úÖ `province` field (‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô array)

Field ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á:
- ‚úÖ `text`, `number`, `date`, `file_upload` ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
- ‚úÖ `lat_long` ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏õ‡πá‡∏ô POINT geometry
- ‚úÖ `checkbox` (multi-select) ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏õ‡πá‡∏ô comma-separated values

### Q2: ‡∏ï‡πâ‡∏≠‡∏á restart backend ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á submission ‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á restart ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏û‡∏≠ ‡∏Å‡∏≤‡∏£ restart ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ:
- ‡πÇ‡∏´‡∏•‡∏î code ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- submission ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

### Q3: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ô migration script ‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å:
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤: ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏≤‡∏à‡πÅ‡∏õ‡∏•‡∏Å (‡∏°‡∏µ `{"..."}`)
- ‚ö†Ô∏è PowerBI: ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ data cleaning

**‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:** ‡∏£‡∏±‡∏ô migration ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### Q4: migration script ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏´‡∏°?
**A:** ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞:
- ‚úÖ ‡πÉ‡∏ä‡πâ Regex Pattern ‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á (`^\\{"[^"]+"\\}$`)
- ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `{"value"}` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‚úÖ ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- ‚úÖ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ rollback ‡πÑ‡∏î‡πâ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ backup)

**‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:** Backup ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ô migration (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤)

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏¢‡∏≠‡∏∞ (> 10 records):

1. ‚úÖ **Backup ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
   ```bash
   pg_dump -U qcollector_user qcollector_dev > backup_before_migration.sql
   ```

2. ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà** (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á submission ‡πÉ‡∏´‡∏°‡πà
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   - ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á: `‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á` (‡πÑ‡∏°‡πà‡∏°‡∏µ `{"..."}`)

3. ‚úÖ **‡∏£‡∏±‡∏ô Migration Script** (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤)
   ```bash
   cd backend/scripts
   node fix-factory-field-format.js
   ```

4. ‚úÖ **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**
   ```sql
   SELECT factory_affiliated FROM [table_name] WHERE factory_affiliated NOT LIKE '%{%';
   ```

5. ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•** (Frontend ‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)

---

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≠‡∏¢ (< 10 records):

1. ‚úÖ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà** (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)

2. üìã **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:**
   - ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‚Üí ‡∏£‡∏±‡∏ô migration
   - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ ‚Üí ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏ß‡πâ

---

## ‡∏™‡∏£‡∏∏‡∏õ

### ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß:
1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `DynamicTableService.js` (2 locations)
2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `Array.isArray()` ‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. Restart backend server
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á migration script

### ‚è≥ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ï‡πà‡∏≠:
1. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà** (‡∏™‡∏£‡πâ‡∏≤‡∏á submission ‡πÉ‡∏´‡∏°‡πà)
2. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤** (3 ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö navigation arrows** (refresh browser ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á)

---

**‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠:**
- ‡∏£‡∏±‡∏ô migration script ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
- ‡πÄ‡∏à‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‚Üí ‡∏™‡πà‡∏á error log ‡∏°‡∏≤
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á script ‚Üí ‡∏Ç‡∏≠ requirement ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:** ‚úÖ Backend ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!
